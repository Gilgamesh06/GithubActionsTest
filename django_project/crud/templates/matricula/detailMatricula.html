{% extends 'base.html' %}
{% load static %}

{% block title %}Buscar Matr√≠cula{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>üîç Buscar Matr√≠cula por ID</h2>
    </div>

    <div class="search-box">
        <input type="number" id="matriculaId" class="form-control" placeholder="Ingrese el ID de la matr√≠cula" min="1">
        <button onclick="buscarMatricula()" class="btn btn-primary">üîç Buscar</button>
    </div>

    <div id="result"></div>

    <div class="mt-3">
        <a href="{% url 'crud:menu' %}" class="btn btn-secondary">‚Ü©Ô∏è Volver al Men√∫</a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'crud/js/apiService.js' %}"></script>
<script>
    async function buscarMatricula() {
        const id = document.getElementById('matriculaId').value;
        const resultDiv = document.getElementById('result');

        if (!id) {
            resultDiv.innerHTML = '<p class="alert alert-warning">‚ö†Ô∏è Por favor ingrese un ID</p>';
            return;
        }

        resultDiv.innerHTML = '<p class="loading">‚è≥ Buscando...</p>';

        try {
            const matricula = await getById('matriculas', id);

            resultDiv.innerHTML = `
                <div class="card mt-3">
                    <div class="card-header">
                        <h3>‚úÖ Matr√≠cula Encontrada</h3>
                    </div>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <label>ID</label>
                            <p>${matricula.ID_MATRICULA}</p>
                        </div>
                        <div class="detail-item">
                            <label>ID Estudiante</label>
                            <p>${matricula.FID_ESTUDIANTE}</p>
                        </div>
                        <div class="detail-item">
                            <label>ID Curso</label>
                            <p>${matricula.FID_CURSO}</p>
                        </div>
                    </div>
                </div>
            `;
        } catch (error) {
            resultDiv.innerHTML = '<p class="alert alert-error">‚ùå Matr√≠cula no encontrada</p>';
        }
    }

    document.getElementById('matriculaId').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') buscarMatricula();
    });
</script>
{% endblock %}
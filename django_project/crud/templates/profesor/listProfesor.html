{% extends 'base.html' %}
{% load static %}

{% block title %}Lista de Profesores{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>üë®‚Äçüè´ Lista de Profesores</h2>
    </div>

    <div id="loading" class="loading">
        <p>‚è≥ Cargando profesores...</p>
    </div>

    <div id="profesores-container" class="hidden">
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Edad</th>
                        <th>G√©nero</th>
                    </tr>
                </thead>
                <tbody id="profesores-list">
                </tbody>
            </table>
        </div>
    </div>

    <div id="empty-state" class="empty-state hidden">
        <h3>üì≠ No hay profesores registrados</h3>
        <p>Comienza registrando un nuevo profesor</p>
        <a href="{% url 'crud:profesor_form' %}" class="btn btn-primary mt-2">‚ûï Registrar Profesor</a>
    </div>

    <div class="mt-3">
        <a href="{% url 'crud:menu' %}" class="btn btn-secondary">‚Ü©Ô∏è Volver al Men√∫</a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'crud/js/apiService.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const loading = document.getElementById('loading');
        const container = document.getElementById('profesores-container');
        const emptyState = document.getElementById('empty-state');
        const tbody = document.getElementById('profesores-list');

        try {
            const profesores = await getAll('profesores');
            loading.classList.add('hidden');

            if (profesores && profesores.length > 0) {
                container.classList.remove('hidden');

                profesores.forEach(profesor => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${profesor.ID_PROFESOR}</td>
                        <td>${profesor.NOMBRE}</td>
                        <td>${profesor.APELLIDO}</td>
                        <td>${profesor.EDAD}</td>
                        <td>${profesor.GENERO === 'M' ? 'Masculino' : profesor.GENERO === 'F' ? 'Femenino' : 'Otro'}</td>
                    `;
                    tbody.appendChild(tr);
                });
            } else {
                emptyState.classList.remove('hidden');
            }
        } catch (error) {
            loading.innerHTML = '<p class="alert alert-error">‚ùå Error al cargar profesores</p>';
        }
    });
</script>
{% endblock %}